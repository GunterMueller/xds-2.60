(* h2d_os9semaphore.def  Apr 7  11:17:54  2000 *)
(* Generated by H2D v1.31.0 from os9semaphore.h. *)
<*+ M2ADDTYPES *>
<*+ M2EXTENSIONS *>
<*+ NOHEADER *> 
<* IF NOT DEFINED(GENTYPEDEF) THEN *> <* NEW GENTYPEDEF+ *> <* END *>

DEFINITION MODULE ["C"] os9semaphore;

IMPORT os9types, os9process, SYSTEM;
(* H2D:  Required IMPORT clause: 
IMPORT os9semaphore, os9types, os9process;
*)
CONST 
  P_OPERATION = 1;   (*  Reserve semaphore  *)
  V_OPERATION = 2;   (*  Release semaphore  *)

CONST 
  S_CASFLAG = 1H;   (*  cas instruction available  *)
  S_NONATOMIC = 2H;   (*  if set, target does not have atomic test/set  *)

(*  Semaphore structure definition  *)

TYPE 
  semaphore = RECORD
    s_value   : os9types.sema_val;                   (*  semaphore value (free/busy status)  *)
    s_lock    : os9types.u_int32;                    (*  semaphore structure lock (use count)  *)
    s_qnext   : os9process.Pr_desc;                  (*  wait queue for process descriptors  *)
    s_qprev   : os9process.Pr_desc;                  (*  wait queue for process descriptors  *)
    s_length  : os9types.u_int32;                    (*  current length of wait queue  *)
    s_owner   : os9types.u_int32;                    (*  current owner of semaphore (process ID)  *)
    s_user    : os9types.u_int32;                    (*  reserved for users         *)
    s_flags   : os9types.u_int32;                    (*  general purpose bit-field flags  *)
    s_sync    : os9types.u_int32;                    (*  integrity sync code  *)
    s_reserved: ARRAY [0..3-1] OF os9types.u_int32;  (*  reserved for system use  *)
  END;

  Semaphore = POINTER TO semaphore;

PROCEDURE _os_sema_init ( arg0: Semaphore ): os9types.error_code;

PROCEDURE _os_sema_p ( arg0: Semaphore ): os9types.error_code;

PROCEDURE _os_sema_term ( arg0: Semaphore ): os9types.error_code;

PROCEDURE _os_sema_v ( arg0: Semaphore ): os9types.error_code;

END os9semaphore.
